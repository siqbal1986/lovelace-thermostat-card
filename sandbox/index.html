<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Exact Volume Knob – v3</title>
<style>
  :root{
    /* Tuned against the reference */
    --bg0:#0b0f13;
    --bg1:#0a0d11;

    --plate0:#151a1f;   /* base plate center */
    --plate1:#0e1319;   /* plate edge */
    --plate-dot:#1f2530;

    --rim-edge:#0a0e13; /* outermost edge */
    --rim-hi:#40505d;   /* cool blue-gray highlight */
    --rim-mid:#141a1f;  /* main body */
    --rim-deep:#0b1016; /* deep groove */

    --face-core:#26303a; /* faint internal glow */
    --face-mid:#1c242d;
    --face-edge:#11171d; /* very dark edge */

    --tick:#49ff5a;     /* LED green */
    --tick-slot:#092012;

    --gloss1:#96a6b4;   /* bright specular */
    --gloss2:#6d7b88;   /* secondary */

    --shadow:#000;
  }
  html,body{
    height:100%; margin:0;
    background:radial-gradient(60% 65% at 50% 40%, var(--bg0) 0%, var(--bg1) 100%);
    display:grid; place-items:center;
    color:#cfd6de; font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  }
  .wrap{ width:min(360px,88vmin); aspect-ratio:1/1; position:relative; }
  .readout{
    position:absolute; inset:auto 0 -2.6rem 0; text-align:center;
    font-variant-numeric:tabular-nums; user-select:none; opacity:.9; font-weight:600;
  }
  svg,.wrap{ user-select:none; -webkit-tap-highlight-color:transparent; touch-action:none; }
</style>
</head>
<body>
<div class="wrap">
<svg id="knobSVG" viewBox="0 0 200 200" width="100%" height="100%" aria-label="Rotary volume knob">
  <defs>
    <!-- Plate -->
    <radialGradient id="plateGrad" cx="50%" cy="42%" r="70%">
      <stop offset="0%"  stop-color="var(--plate0)"/>
      <stop offset="100%" stop-color="var(--plate1)"/>
    </radialGradient>
    <filter id="plateShadow" x="-45%" y="-45%" width="190%" height="190%">
      <feDropShadow dx="0" dy="7" stdDeviation="9.5" flood-color="#000" flood-opacity=".55"/>
    </filter>
    <pattern id="dots" width="10" height="10" patternUnits="userSpaceOnUse">
      <!-- smaller + fainter -->
      <circle cx="1.4" cy="1.4" r="0.9" fill="var(--plate-dot)" opacity=".14"/>
    </pattern>

    <!-- Rim (machined metal look) -->
    <linearGradient id="rimBand" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%"   stop-color="#0c1116"/>
      <stop offset="18%"  stop-color="var(--rim-hi)"/>
      <stop offset="50%"  stop-color="var(--rim-mid)"/>
      <stop offset="82%"  stop-color="var(--rim-hi)"/>
      <stop offset="100%" stop-color="var(--rim-edge)"/>
    </linearGradient>
    <radialGradient id="rimDepth" cx="48%" cy="40%" r="70%">
      <stop offset="0%"  stop-color="#121820"/>
      <stop offset="65%" stop-color="var(--rim-mid)"/>
      <stop offset="100%" stop-color="var(--rim-deep)"/>
    </radialGradient>

    <!-- Face dome: darker edge, slight cold glow in center -->
    <radialGradient id="faceGrad" cx="50%" cy="50%" r="70%">
      <stop offset="0%"  stop-color="var(--face-core)" stop-opacity=".40"/>
      <stop offset="36%" stop-color="var(--face-mid)"  stop-opacity=".82"/>
      <stop offset="100%" stop-color="var(--face-edge)" stop-opacity="1"/>
    </radialGradient>

    <!-- Inner shadow ring to recess face -->
    <filter id="innerShadow" x="-70%" y="-70%" width="240%" height="240%">
      <feOffset dx="0" dy="1"/>
      <feGaussianBlur stdDeviation="2.3"/>
      <feComposite in2="SourceAlpha" operator="arithmetic" k2="-1" k3="1"/>
      <feColorMatrix type="matrix"
        values="0 0 0 0 0
                0 0 0 0 0
                0 0 0 0 0
                0 0 0 .82 0"/>
      <feBlend in="SourceGraphic"/>
    </filter>

    <!-- LED glow -->
    <filter id="ledGlow" x="-160%" y="-300%" width="420%" height="650%">
      <feGaussianBlur stdDeviation="0.9" result="g"/>
      <feMerge><feMergeNode in="g"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>

    <!-- Glossy specular blur -->
    <filter id="specBlur" x="-40%" y="-40%" width="180%" height="180%">
      <feGaussianBlur stdDeviation="1"/>
    </filter>

    <!-- Soft oval reflection at bottom of face (masked) -->
    <radialGradient id="ovalGrad" cx="50%" cy="50%" r="50%">
      <stop offset="0%" stop-color="#0c1116" stop-opacity=".70"/>
      <stop offset="100%" stop-color="#0c1116" stop-opacity="0"/>
    </radialGradient>
    <mask id="ovalMask">
      <!-- restrict oval within the face -->
      <rect x="0" y="0" width="200" height="200" fill="black"/>
      <circle cx="100" cy="100" r="51.7" fill="white"/>
    </mask>
  </defs>

  <!-- Base plate -->
  <g filter="url(#plateShadow)">
    <circle cx="100" cy="100" r="93" fill="url(#plateGrad)"/>
    <circle cx="100" cy="100" r="93" fill="url(#dots)"/>
  </g>

  <!-- Rotating group -->
  <g id="knob" transform="rotate(0 100 100)">
    <!-- Thick glossy rim -->
    <circle cx="100" cy="100" r="61" fill="url(#rimBand)"/>
    <circle cx="100" cy="100" r="61" fill="url(#rimDepth)" opacity=".88"/>
    <!-- thin dark outer edge -->
    <circle cx="100" cy="100" r="61" fill="none" stroke="#090d11" stroke-width="1.2" opacity=".9"/>

    <!-- face bevel separation -->
    <circle cx="100" cy="100" r="55" fill="none" stroke="#0c1116" stroke-width="2" opacity=".95"/>

    <!-- face -->
    <circle cx="100" cy="100" r="51.7" fill="url(#faceGrad)" filter="url(#innerShadow)"/>

    <!-- bottom internal oval reflection (darker, softer, lower) -->
    <g mask="url(#ovalMask)">
      <ellipse cx="100" cy="132.5" rx="29" ry="9.8" fill="url(#ovalGrad)"/>
    </g>

    <!-- top-right tight specular (1–2 o'clock), shorter and brighter at start -->
    <path d="M132.5 56.2 A61 61 0 0 1 148.8 71.0"
          fill="none" stroke="var(--gloss1)" stroke-width="2.1" stroke-linecap="round"
          opacity=".38" filter="url(#specBlur)"/>
    <path d="M148.8 71.0 A61 61 0 0 1 154.2 83.7"
          fill="none" stroke="var(--gloss2)" stroke-width="1.3" stroke-linecap="round"
          opacity=".18" filter="url(#specBlur)"/>

    <!-- LED tick: thinner + recessed slot -->
    <g filter="url(#ledGlow)">
      <rect x="99.45" y="41.8" width="1.05" height="5.4" rx="0.7" fill="var(--tick-slot)" opacity=".95"/>
      <rect x="99.15" y="40.9" width="1.55" height="7.2" rx="0.9" fill="var(--tick)"/>
    </g>
  </g>

  <!-- Contact shadow -->
  <ellipse cx="100" cy="137" rx="35" ry="9.3" fill="var(--shadow)" opacity=".40"/>
</svg>

<div class="readout">Volume: <span id="val">50</span>%</div>
</div>

<script>
(() => {
  const svg = document.getElementById('knobSVG');
  const knob = document.getElementById('knob');
  const valueEl = document.getElementById('val');

  const CX=100, CY=100, MIN=-135, MAX=135;
  let angle=0, dragging=false, startAngle=0, startKnob=0;

  const clamp=(v,a,b)=>Math.min(b,Math.max(a,v));
  const a2v=a=>Math.round(((clamp(a,MIN,MAX)-MIN)/(MAX-MIN))*100);
  const v2a=v=>MIN+(clamp(v,0,100)/100)*(MAX-MAX+270); // same span (270deg)
  function render(){ knob.setAttribute('transform',`rotate(${angle} ${CX} ${CY})`); valueEl.textContent=a2v(angle); }

  function clientToAngle(e){
    const pt = svg.createSVGPoint();
    pt.x = (e.touches?e.touches[0].clientX:e.clientX);
    pt.y = (e.touches?e.touches[0].clientY:e.clientY);
    const p = pt.matrixTransform(svg.getScreenCTM().inverse());
    let deg = Math.atan2(p.y-CY, p.x-CX)*180/Math.PI;
    deg += 90; deg = ((deg+180)%360)-180; return deg;
  }

  function onDown(e){ e.preventDefault(); dragging=true; startAngle=clientToAngle(e); startKnob=angle; }
  function onMove(e){
    if(!dragging) return;
    e.preventDefault();
    let d = clientToAngle(e)-startAngle;
    if(d>180) d-=360; if(d<-180) d+=360;
    angle = clamp(startKnob+d, MIN, MAX); render();
  }
  function onUp(){ dragging=false; }

  svg.addEventListener('mousedown', onDown);
  window.addEventListener('mousemove', onMove);
  window.addEventListener('mouseup', onUp);
  svg.addEventListener('touchstart', onDown, {passive:false});
  window.addEventListener('touchmove', onMove, {passive:false});
  window.addEventListener('touchend', onUp);

  window.addEventListener('keydown',e=>{
    const step=(MAX-MIN)/100;
    if(e.key==='ArrowLeft'||e.key==='ArrowDown'){ angle=clamp(angle-step*2,MIN,MAX); render(); }
    else if(e.key==='ArrowRight'||e.key==='ArrowUp'){ angle=clamp(angle+step*2,MIN,MAX); render(); }
    else if(e.key==='Home'){ angle=MIN; render(); }
    else if(e.key==='End'){ angle=MAX; render(); }
  });

  angle = (MIN+MAX)/2; // 50%
  render();

  window.knobAPI={
    setValue(v){ angle = MIN + (clamp(v,0,100)/100)*(MAX-MIN); render(); },
    getValue(){ return a2v(angle); },
    setAngle(a){ angle=clamp(a,MIN,MAX); render(); },
    getAngle(){ return angle; }
  };
})();
</script>
</body>
</html>
